CREATE DATABASE StudyBuddy;

CREATE TABLE userdetails (
	Username VARCHAR(255) NOT NULL,
	Email VARCHAR(255) NOT NULL,
	AccountPassword VARCHAR(255) NOT NULL,
	AccountStatus VARCHAR(255) NOT NULL,
	UNIQUE(Username),
	PRIMARY KEY(Email)
)

CREATE TABLE LoginHistory (
	ID INT NOT NULL AUTO_INCREMENT,
	Username VARCHAR(255),
	Time DATETIME NOT NULL,
	Result BOOLEAN NOT NULL
)

CREATE TABLE contentwrapper (
	ID INT NOT NULL AUTO_INCREMENT,
	Title TEXT NOT NULL,
	Description TEXT,
	Content TEXT,
	ContentType VARCHAR(255) NOT NULL,
	QuestionType VARCHAR(255),
	Permissions VARCHAR(255) NOT NULL,
	Creator VARCHAR(255) NOT NULL,
	Filters TEXT,
	PRIMARY KEY(ID)
)

CREATE TABLE apikeys (
	ID INT NOT NULL AUTO_INCREMENT,
	TempKey TEXT NOT NULL,
	Username VARCHAR(255) NOT NULL,
	TimeCreated DATETIME NOT NULL,
	PRIMARY KEY(ID)
)

CREATE TABLE wrapperrelations (
	ID INT NOT NULL AUTO_INCREMENT,
	ParentID INT NOT NULL,
	ChildID INT NOT NULL,
	ChildOrder INT NOT NULL,
	PRIMARY KEY(ID)
)

CREATE TABLE wrapperpermissions (
	ID INT NOT NULL AUTO_INCREMENT,
	ContentID INT NOT NULL,
	Username VARCHAR(255) NOT NULL,
  PRIMARY KEY(ID)
)

CREATE TABLE questionoptions (
	ID INT NOT NULL AUTO_INCREMENT,
	QuestionID INT NOT NULL,
	Topic TEXT,
	Aspect TEXT,
	TableEntry TEXT,
	Node1 TEXT,
	Node2 TEXT,
	Relationship TEXT,
	Stem TEXT,
	Explanation TEXT,
	PRIMARY KEY(ID)
)

CREATE TABLE questionhistory (
	ID INT NOT NULL AUTO_INCREMENT,
	QuestionID INT NOT NULL,
	QuestionOptionID INT NOT NULL,
	Settings TEXT NOT NULL,
	DateAttempted DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
	TimeTaken INT NOT NULL,
	Result FLOAT NOT NULL,
	Username VARCHAR(255) NOT NULL,
	TestID INT NOT NULL,
	PRIMARY KEY(ID)
)

CREATE TABLE testhistory (
	ID INT NOT NULL AUTO_INCREMENT,
	NoteID INT NOT NULL,
	DateAttempted DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
	TimeTaken INT NOT NULL,
	Result FLOAT NOT NULL,
	Username VARCHAR(255) NOT NULL,
	PRIMARY KEY(ID)
)

CREATE TABLE subscriptions (
	ID INT NOT NULL AUTO_INCREMENT,
	Username VARCHAR(255) NOT NULL,
	ContentID INT NOT NULL,
	PRIMARY KEY(ID)
)
